cache:
  key: "${CI_COMMIT_REF_SLUG}"
  paths:
    - .pre-commit-cache

pre-commit:
  stage: lint
  image: python:3.14-slim
  before_script:
    - apt-get update && apt-get install -y git curl unzip
    - curl -fsSL https://releases.hashicorp.com/terraform/1.9.0/terraform_1.9.0_linux_amd64.zip -o terraform.zip
    - unzip terraform.zip && mv terraform /usr/local/bin/
    - curl -s https://raw.githubusercontent.com/terraform-linters/tflint/master/install_linux.sh | bash
    - pip install pre-commit
  script:
    - pre-commit run --all-files
